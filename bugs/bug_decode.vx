struct EmptyStruct {
	b []int
}

fn decode_array[T](mut val []T) {
	val << 42
}

fn decode_struct[T]() T {
	val := T{}
	$if T is $struct {
		$for field in T.fields {
			$if field.is_array {
				decode_array(mut val.$(field.name))
				// mut arr := val.$(field.name)
				// decode_array(mut arr)
				// println('${field.name}: ${arr}')
				// val.$(field.name) = arr
			}
		}
	}
	return val
}

fn test_decoder() {
	val := decode_struct[EmptyStruct]()
	println(val)
}

test_decoder()

