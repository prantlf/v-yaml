struct EmptyStruct {
	b []int
}

fn encode_array[T](val []T) {
}

fn encode_struct[T](val T) {
	$if T is $struct {
		$for field in T.fields {
			$if field.is_array {
				// encode_array(val.$(field.name))
				arr := val.$(field.name)
				encode_array(arr)
			}
		}
	}
}

fn test_encoder() {
	em := EmptyStruct{}
	encode_struct(em)
}
